# -*- coding: utf-8 -*-
import numpy as np


def get_hex_sequence(filename):
    """
    Get hexadecimal sequence from .bytes file.
    :param filename: The name of .bytes file
    :return: The hexadecimal sequence
    """
    # save hexadecimal sequence
    hex_seq = []
    with open(filename, 'r') as f:
        # read 4096 lines to generate 256 * 256 gray image
        for i in range(4096):
            line = f.readline().split()[1:]
            for j in range(16):
                hex_seq.append(line[j])

    return hex_seq


def hex2mat(filename):
    """
    Convert a hexadecimal sequence to a 256 * 256 matrix. "??" is converted to 0.
    :param filename: Given .bytes file
    :return: 256 * 256 numpy arrays
    """
    hex_seq = get_hex_sequence(filename)
    vec_seq = []
    for i in range(4096):
        if hex_seq[i] == "??":
            # dynamic value
            vec_seq.append(0)
        else:
            vec_seq.append(int(hex_seq[i], 16))

    return np.reshape(np.asarray(vec_seq), (256, 256))
