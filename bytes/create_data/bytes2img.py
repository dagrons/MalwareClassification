# -*- coding: utf-8 -*-
import numpy as np


def get_hex_sequence(filename):
    """
    Get hexadecimal sequence from .bytes file.
    :param filename: The name of .bytes file
    :return: The hexadecimal sequence
    """
    # save hexadecimal sequence
    hex_seq = []
    with open(filename, 'r') as f:
        a = f.readline()
        while a:
            line = a.split()[1:]
            hex_seq += line
            a = f.readline()

    return hex_seq


def hex2mat(filename):
    """
    Convert a hexadecimal sequence to a n * 16 matrix. "??" is converted to 0.
    :param filename: Given .bytes file
    :return: n * 256 numpy arrays
    """
    hex_seq = get_hex_sequence(filename)
    vec_seq = []
    for i in range(len(hex_seq)):
        if hex_seq[i] != "??":
            vec_seq.append(int(hex_seq[i], 16))
        else:
            vec_seq.append(0)
    vec_seq = np.asarray(vec_seq)

    return np.reshape(vec_seq, (-1, 16))
