from asm.create_data.generate_dataset import get_dataset
from sklearn.metrics import accuracy_score, precision_score, f1_score, recall_score
from sklearn.ensemble import RandomForestClassifier

dataset = get_dataset('E:/malware/vec/train/')
x_train, y_train = dataset.x, dataset.y
dataset = get_dataset('E:/malware/vec/test/')
x_test, y_test = dataset.x, dataset.y

model = RandomForestClassifier()
model.fit(x_train, y_train)
y_predict = model.predict(x_test)

accuracy = accuracy_score(y_test, y_predict)
precision = precision_score(y_test, y_predict, average='weighted')
recall = recall_score(y_test, y_predict, average='weighted')
f1 = f1_score(y_test, y_predict, average='weighted')
print('accuracy:', accuracy)
print('precision:', precision)
print('recall:', recall)
print('f1-score:', f1)
